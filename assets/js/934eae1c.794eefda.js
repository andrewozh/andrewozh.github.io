"use strict";(self.webpackChunkdevops_sandbox=self.webpackChunkdevops_sandbox||[]).push([[7500],{8453:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>l});var c=n(6540);const i={},r=c.createContext(i);function t(e){const s=c.useContext(r);return c.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),c.createElement(r.Provider,{value:s},e.children)}},8753:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>l,default:()=>x,frontMatter:()=>t,metadata:()=>c,toc:()=>d});const c=JSON.parse('{"id":"db/clickhouse/clickhouse-cloud","title":"Clickhouse Cloud","description":"|Tool|ClickHouse Cloud|","source":"@site/docs/db/clickhouse/clickhouse-cloud.md","sourceDirName":"db/clickhouse","slug":"/db/clickhouse/clickhouse-cloud","permalink":"/docs/db/clickhouse/clickhouse-cloud","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Altinity Clickhouse Operator","permalink":"/docs/db/clickhouse/clickhouse-altinity"},"next":{"title":"Apache Kafka","permalink":"/docs/db/kafka/"}}');var i=n(4848),r=n(8453);const t={},l="Clickhouse Cloud",o={},d=[{value:"TODO",id:"todo",level:2},{value:"Architectire",id:"architectire",level:2},{value:"Usecases",id:"usecases",level:2},{value:"Maintenence",id:"maintenence",level:2},{value:"Setup",id:"setup",level:3},{value:"Backup / Restore",id:"backup--restore",level:3},{value:"Scaling",id:"scaling",level:3},{value:"Upgrade",id:"upgrade",level:3},{value:"Patform integration",id:"patform-integration",level:2},{value:"KNOWN ISSUES",id:"known-issues",level:2}];function a(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"clickhouse-cloud",children:"Clickhouse Cloud"})}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:(0,i.jsx)(s.strong,{children:"Tool"})}),(0,i.jsx)(s.th,{children:(0,i.jsx)(s.a,{href:"https://clickhouse.com/cloud",children:"ClickHouse Cloud"})})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Type"})}),(0,i.jsx)(s.td,{children:"terrafrom-provider"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Deploy"})}),(0,i.jsx)(s.td,{children:"crossplane"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Backup"})}),(0,i.jsx)(s.td,{children:"manual"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Scaling"})}),(0,i.jsx)(s.td,{children:"automated"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"CLI"})}),(0,i.jsx)(s.td,{children:"clickhouse-client"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"UI"})}),(0,i.jsx)(s.td,{children:"web"})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:"todo",children:"TODO"}),"\n",(0,i.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","add all available settings to XRD"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","automate creation of DB and Users (operator)"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"architectire",children:"Architectire"}),"\n",(0,i.jsx)(s.p,{children:"Crossplane-terraform + terraform provider for ClickHouse Cloud.\nTerrafrom Workspace wrapped in Composition Resource Definition (XRD).\nAdmin credentials output as a secret."}),"\n",(0,i.jsx)(s.h2,{id:"usecases",children:"Usecases"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Basic: create db, create user, connect, etc."}),"\n",(0,i.jsx)(s.li,{children:"Common: write data, read data, replication, etc."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"maintenence",children:"Maintenence"}),"\n",(0,i.jsx)(s.h3,{id:"setup",children:"Setup"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"setup terraform provider"}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'cat <<EOF > .secret\nclickhouse_org: "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"\nclickhouse_key: "xxxxxxxxxxxxxxxxxxxx"\nclickhouse_secret: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"\nEOF\ncat <<EOF | kubectl apply -f -\napiVersion: v1\nkind: Secret\nmetadata:\n  name: clickhouse-cloud-secret\n  namespace: crossplane\ntype: Opaque\ndata:\n  creds.auto.tfvars: $(cat .secret | base64)\nEOF\n'})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"create Clickhouse Cloud service"}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-yaml",children:"apiVersion: clickhousecloud.crossplane.io/v1alpha1\nkind: xService\nmetadata:\n  name: clickhouse\nspec:\n  name: clickhouse\n"})}),"\n",(0,i.jsx)(s.h3,{id:"backup--restore",children:"Backup / Restore"}),"\n",(0,i.jsx)(s.h3,{id:"scaling",children:"Scaling"}),"\n",(0,i.jsx)(s.h3,{id:"upgrade",children:"Upgrade"}),"\n",(0,i.jsx)(s.h2,{id:"patform-integration",children:"Patform integration"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"how this tool integrated into a platform"}),"\n",(0,i.jsx)(s.li,{children:"how to use it in a platform"}),"\n",(0,i.jsx)(s.li,{children:"how to debug"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"known-issues",children:"KNOWN ISSUES"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["On ",(0,i.jsx)(s.code,{children:"Free Tier"})," with provider versios 3.3.3 can't update already created service"]}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:'Error: Error setting service backup configuration\n\nwith module.dev.module.clickhouse.clickhouse_service.service,\non dev/clickhouse/main.tf line 1, in resource "clickhouse_service" "service":\n  1: resource "clickhouse_service" "service" {\n\nCould not update service backup settings, unexpected error: status: 400,\nbody:\n{"requestId":"90ab9fdd-4446-4d44-a9fe-aeecc29af7de","error":"BAD_REQUEST:\ncannot update backup configuration for development tier\nservice","status":400}\n'})}),"\n",(0,i.jsxs)(s.p,{children:["Related GitHub issue: ",(0,i.jsx)(s.a,{href:"https://github.com/ClickHouse/terraform-provider-clickhouse/issues/167",children:"https://github.com/ClickHouse/terraform-provider-clickhouse/issues/167"})]})]})}function x(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}}}]);