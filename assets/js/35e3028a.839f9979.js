"use strict";(self.webpackChunkdevops_sandbox=self.webpackChunkdevops_sandbox||[]).push([[1544],{4701:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"observability/metrics/articles/grafana-dashboard-patcher","title":"Grafana Dashboard patcher","description":"TODO","source":"@site/docs/observability/metrics/articles/grafana-dashboard-patcher.md","sourceDirName":"observability/metrics/articles","slug":"/observability/metrics/articles/grafana-dashboard-patcher","permalink":"/docs/observability/metrics/articles/grafana-dashboard-patcher","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"article","permalink":"/docs/tags/article"},{"inline":true,"label":"grafana","permalink":"/docs/tags/grafana"},{"inline":true,"label":"metrics","permalink":"/docs/tags/metrics"},{"inline":true,"label":"observability","permalink":"/docs/tags/observability"}],"version":"current","frontMatter":{"tags":["article","grafana","metrics","observability"]},"sidebar":"tutorialSidebar","previous":{"title":"Alert Manager","permalink":"/docs/observability/metrics/alertmanager"},"next":{"title":"Prometheus Stack Architecture","permalink":"/docs/observability/metrics/articles/prometheus-stack-architecture"}}');var n=t(4848),s=t(8453);const l={tags:["article","grafana","metrics","observability"]},i="Grafana Dashboard patcher",c={},o=[{value:"TODO",id:"todo",level:2},{value:"Tool",id:"tool",level:2}];function d(e){const a={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.header,{children:(0,n.jsx)(a.h1,{id:"grafana-dashboard-patcher",children:"Grafana Dashboard patcher"})}),"\n",(0,n.jsx)(a.h2,{id:"todo",children:"TODO"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["fix: only forst metric in ",(0,n.jsx)(a.code,{children:"expr"})," is patched"]}),"\n"]}),"\n",(0,n.jsx)(a.h2,{id:"tool",children:"Tool"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"add specific variables"}),"\n",(0,n.jsx)(a.li,{children:"patch all metrics in expr to use variables"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:'INPUT_FILE="$1"\njq \'.templating.list += [\n    {\n      "name": "datacenter",\n      "query": "label_values(kube_deployment_labels,datacenter)",\n      "label": "Datacenter",\n      "type": "query",\n      "datasource": null,\n      "refresh": 1,\n      "includeAll": false,\n      "multi": false\n    },\n    {\n      "name": "cluster",\n      "query": "label_values(kube_deployment_labels{datacenter=\\"$datacenter\\"},clusterID)",\n      "label": "Cluster",\n      "type": "query",\n      "datasource": null,\n      "refresh": 1,\n      "includeAll": false,\n      "multi": false\n    }\n  ] | (.. | objects | select(has("expr")) | .expr) |= sub("\\\\{"; "{datacenter=\\"$datacenter\\",clusterID=\\"$cluster\\",")\n\' "$INPUT_FILE" >"$INPUT_FILE.tmp" && mv "$INPUT_FILE.tmp" "$INPUT_FILE"\n'})})]})}function u(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,a,t)=>{t.d(a,{R:()=>l,x:()=>i});var r=t(6540);const n={},s=r.createContext(n);function l(e){const a=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function i(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),r.createElement(s.Provider,{value:a},e.children)}}}]);